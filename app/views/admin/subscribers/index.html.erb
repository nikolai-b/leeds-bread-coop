<% model_class = Subscriber %>
<div class="page-header">
  <h1>
    <%= t '.title', :default => "Subscribers" %>
  </h1>
</div>

<div class="btn-group">
  <%= link_to 'Pays with Stripe', params.merge(pays_with_stripe: true, pays_with_bacs: false, page: 1), class: "btn btn-default" %>
  <%= link_to 'Pays with BACS', params.merge(pays_with_stripe: false, pays_with_bacs: true, page: 1), class: "btn btn-default" %>
  <%= link_to 'All', params.merge(pays_with_stripe: false, pays_with_bacs: false), class: "btn btn-default" %>
</div>

</br>

<%= bootstrap_form_tag(url: admin_subscribers_path, method: :get) do %>
  <%= text_field_tag :search, params[:search] %>
  <%= submit_tag "Search", :name => nil %>
<% end %>

</br>
<%= will_paginate @subscribers, renderer: BootstrapPagination::Rails %>


<table class="table table-striped">
  <thead>
    <tr>
      <th>
        <%= model_class.human_attribute_name(:full_name) %>
      </th>
      <th>
        <%= model_class.human_attribute_name(:collection_point) %>
      </th>
      <th>
        <%= model_class.human_attribute_name(:email) %>
      </th>
      <th>
        <%= model_class.human_attribute_name(:phone) %>
      </th>
      <th>
        <%= t '.actions', :default => t("helpers.actions") %>
      </th>
    </tr>
  </thead>
  <tbody>
    <% @subscribers.each do |subscriber| %>
      <tr>
        <td>
          <%= link_to subscriber.full_name, [:admin, subscriber] %>
        </td>
        <td>
          <%= subscriber.collection_point.name %>
        </td>
        <td>
          <%= subscriber.email %>
        </td>
        <td>
          <%= subscriber.phone %>
        </td>
        <td>
          <%= link_to t('.edit', :default => t("helpers.links.edit")), edit_admin_subscriber_path(subscriber), class: 'btn btn-default btn-xs' %>
          <%= link_to t('.subscriptions', :default => t("helpers.links.subscriptions")), edit_all_admin_subscriber_subscriptions_path(subscriber), :class => 'btn btn-default btn-xs' %>
          <%= link_to t('.holidays', :default => t("helpers.links.holidays")), admin_subscriber_holidays_path(subscriber), :class => 'btn btn-default btn-xs' %>
          <%= link_to t('.destroy', :default => t("helpers.links.destroy")), [:admin, subscriber], method: :delete, data: { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-default btn-xs btn-danger' %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= form_tag import_admin_subscribers_path, multipart: true do %>
  <%= file_field_tag :file %>
  <%= submit_tag "Import" %>
<% end %>

<%= link_to t('.new', :default => t("helpers.links.new")), new_admin_subscriber_path, :class => 'btn btn-primary' %>

<%= will_paginate @subscribers, renderer: BootstrapPagination::Rails %>

<p>
  <%= link_to "Download CSV", admin_subscribers_path(format: "csv"), class: 'btn btn-sm btn-success' %>
</p>

